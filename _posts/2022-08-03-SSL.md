# SSL

<br>

### Window CA를 이용한 인증서 실습

구상도

![2022-08-03-01구상도](../images/2022-08-03-SSL/2022-08-03-01구상도.PNG)

<br>

Win cap 이용해서 인증서 옮기기

![2022-08-03-02윈캡이용해서인증서옮기기](../images/2022-08-03-SSL/2022-08-03-02윈캡이용해서인증서옮기기.PNG)

CA에서 받은 인증서를 Webserver로 옮겨 주시면 됩니다.

<br>

Webserver에서 인증서 확인

![2022-08-03-03옮긴거확인](../images/2022-08-03-SSL/2022-08-03-03옮긴거확인.PNG)

<br>

httpd 설치

![2022-08-03-04httpd설치](../images/2022-08-03-SSL/2022-08-03-04httpd설치.PNG)

<br>

ssl 설치

![2022-08-03-05ssl설치](../images/2022-08-03-SSL/2022-08-03-05ssl설치.PNG)

<br>

ssl 설정 변경

![2022-08-03-06설정파일](../images/2022-08-03-SSL/2022-08-03-06설정파일.PNG)

![2022-08-03-07인증서사설키위치정의](../images/2022-08-03-SSL/2022-08-03-07인증서사설키위치정의.PNG)

인증서와 사설키의 위치를 지정해 주시면 됩니다.

<br>

httpd 설정 변경

![2022-08-03-08httpd설정](../images/2022-08-03-SSL/2022-08-03-08httpd설정-16595997042449.PNG)

<br>

인증서 추출

![2022-08-03-09인증서추출](../images/2022-08-03-SSL/2022-08-03-09인증서추출.PNG)

아까 Win cap을 이용해 옮겨놧던 인증서에서 인증서와 개인키를 추출 해주시면 됩니다.

개인키 추출

![2022-08-03-10개인키추출](../images/2022-08-03-SSL/2022-08-03-10개인키추출.PNG)

<br>

인증서 개인키 복사

![2022-08-03-11인증서개인키복사](../images/2022-08-03-SSL/2022-08-03-11인증서개인키복사.PNG)

<br>Client에서 확인

![2022-08-03-12고급누륵](../images/2022-08-03-SSL/2022-08-03-12고급누륵.PNG)

고급을 눌러주시면 됩니다.

<br>

예외추가 보안예외 확인

![2022-08-03-13예외추가보안예외확인](../images/2022-08-03-SSL/2022-08-03-13예외추가보안예외확인.PNG)

눌러주시면 됩니다.

<br>

누른 후

![2022-08-03-14결과](../images/2022-08-03-SSL/2022-08-03-14결과.PNG)

평소에 저희가 실습했던 화면이 나오게 됩니다.

<br>

네이버 와 좌측 상단 자물쇠 비교

![2022-08-03-19자물쇠비교](../images/2022-08-03-SSL/2022-08-03-19자물쇠비교.PNG)

네이버는 초록색 httpd는 느낌표가 있는게 보입니다.

초록색은 인증서 인증이 완료된 것이고 느낌표는 아직 인증이 덜 된 상태인 겁니다.

나머지 인증을 더 해보도록 하겠습니다.

<br>

Client에서 CA인증서 다운

![2022-08-03-15ca에서인증서다운](../images/2022-08-03-SSL/2022-08-03-15ca에서인증서다운.PNG)

CA 인증서 설치를 해주셔야 합니다.

<br>

인증서 설치

![2022-08-03-15인증서설치](../images/2022-08-03-SSL/2022-08-03-15인증서설치.PNG)

<br>

인증서 설치 2

![2022-08-03-16인증서설치2](../images/2022-08-03-SSL/2022-08-03-16인증서설치2.PNG)

<br>

인증서 설치 확인

![2022-08-03-17인증서설치3](../images/2022-08-03-SSL/2022-08-03-17인증서설치3.PNG)

도구 > 인터넷옵션에 들어가시면 확인 가능 합니다.

<br>

확인해 보기

![2022-08-03-18확인하기](../images/2022-08-03-SSL/2022-08-03-18확인하기.PNG)

아직 자물쇠가 바뀌지 않았습니다.

DNS를 설정 해주고 다시 해 보겠습니다.

<br>

DNS 설정

![2022-08-03-21dns설정](../images/2022-08-03-SSL/2022-08-03-21dns설정.PNG)

구상도에 없었지만 DNS를 활욜 해보도록 하겠습니다.

저는 2003Window를 활용해서 DNS를 설정 하였습니다.

<br>

확인하기

![2022-08-03-20자물쇠완료](../images/2022-08-03-SSL/2022-08-03-20자물쇠완료.PNG)

자물쇠가 초록색으로 변한 모습이 확인 가능 합니다.

인증서 인증이 완료 된 것입니다.

<br>

<br>

<br>

### Linux CA를 이용한 인증서 실습

<br>

구상도

![2022-08-03-22구상도](../images/2022-08-03-SSL/2022-08-03-22구상도.PNG)

<br>

CA에 ssl 설치

![2022-08-03-23ssl설치](../images/2022-08-03-SSL/2022-08-03-23ssl설치.PNG)

<br>

인증서 만들기

![2022-08-03-24csr만들기](../images/2022-08-03-SSL/2022-08-03-24csr만들기.PNG)

Common Name은 중요합니다. 인증서 이름과 관련이 되있는 곳이니 신중하게 써주시기 바랍니다.

<br>

인증서 확인

![2022-08-03-25결과보기](../images/2022-08-03-SSL/2022-08-03-25결과보기.PNG)

<br>

인증서 생성 요청

![2022-08-03-26인증서생성요청](../images/2022-08-03-SSL/2022-08-03-26인증서생성요청.PNG)

유효기간 365일의 x509형태의 내가 가진 키로 인증을 하겠다 라고 만든 겁니다.

<br>

webserver 인증서 발급

![2022-08-03-27웹서버2인증서발급](../images/2022-08-03-SSL/2022-08-03-27웹서버2인증서발급.PNG)

<br>

개인키 생성

![2022-08-03-28개인키생성](../images/2022-08-03-SSL/2022-08-03-28개인키생성.PNG)

<br>

개인키 확인

![2022-08-03-29개인키확인](../images/2022-08-03-SSL/2022-08-03-29개인키확인.PNG)

<br>

인증서 생성

![2022-08-03-30인증서생성완료](../images/2022-08-03-SSL/2022-08-03-30인증서생성완료.PNG)

인증서 생성까지 완료 하였습니다.

<br>

인증서 Web Server로 옮기기

![2022-08-03-31인증서옮기기](../images/2022-08-03-SSL/2022-08-03-31인증서옮기기.PNG)

Window 실습때 Win cap을 쓴것과 똑같은 역할을 해주는 명령어 입니다.

<br>

Web Server에서 확인

![2022-08-03-32웹서버에서확인](../images/2022-08-03-SSL/2022-08-03-32웹서버에서확인.PNG)

제대로 옮겨진 것이 확인 되었습니다.

똑같은 방법으로 webserver-2.key도 옮겨주시면 됩니다.

<br>

관련 디렉터리로 이동

![2022-08-03-33디렉터리로옮기기](../images/2022-08-03-SSL/2022-08-03-33디렉터리로옮기기.PNG)

옮겨온 파일을 관련 디렉터리로 옮겨주시면 됩니다.

<br>

인증서, 사설키 위치 변경 1

![2022-08-03-35ssl설정변경](../images/2022-08-03-SSL/2022-08-03-35ssl설정변경.PNG)

![2022-08-03-34ssl설정변경](../images/2022-08-03-SSL/2022-08-03-34ssl설정변경.PNG)

이렇게 위치를 바꿔주시면 됩니다.

<br>

인증서, 사설키 위치 변경 2

![2022-08-03-37httpd설정변경](../images/2022-08-03-SSL/2022-08-03-37httpd설정변경.PNG)

![2022-08-03-36httpd설정변경](../images/2022-08-03-SSL/2022-08-03-36httpd설정변경.PNG)

위와 똑같이 경로만 webserver-2.key로 바꿔주시면 됩니다.

<br>

데몬 재시작, 상태확인

![2022-08-03-38재시작](../images/2022-08-03-SSL/2022-08-03-38재시작.PNG)

설정을 바꾸었으니 재시작 해서 동기화를 해주시고 잘 동작 하는지 상태를 한번 확인 해봅니다.

<br>

Client에서 확인

![2022-08-03-39고급](../images/2022-08-03-SSL/2022-08-03-39고급.PNG)

아까랑 똑같이 고급 > 예외추가 > 보안예외 확인 눌러 주시면 됩니다.

<br>

확인 2

![2022-08-03-40더보기](../images/2022-08-03-SSL/2022-08-03-40더보기.PNG)

자물쇠 누르고 > 더보기 누르시고

<br>

확인 3

![2022-08-03-41인증서보기상세정보](../images/2022-08-03-SSL/2022-08-03-41인증서보기상세정보.PNG)

인증서 보기 > 상세정보에 가서 아까 만들었던 인증서가 들어가 있으면 성공 입니다.

<br>

Win cap 사용해서 rootCA 가져오기

![2022-08-03-42윈캡으로rootca가져오기](../images/2022-08-03-SSL/2022-08-03-42윈캡으로rootca가져오기.PNG)

rootCA를 Client로 옮겨 주셔야 합니다.

<br>

가져오기

![2022-08-03-43가져오기확인](../images/2022-08-03-SSL/2022-08-03-43가져오기확인.PNG)

<br>

인증서 호출

![2022-08-03-44인증서호출](../images/2022-08-03-SSL/2022-08-03-44인증서호출.PNG)

설정 > 고급 > 인증서 > 인증서 가져오기 순으로 들어 가셔서 인증서를 호출 하시면 됩니다.

<br>

DNS 만들기

![2022-08-03-46c12dns만들기](../images/2022-08-03-SSL/2022-08-03-46c12dns만들기.PNG)

이번에도 2003을 이용해서 DNS에 c12.kh를 만들어 줍니다.

<br>

인증서 보기

![2022-08-03-45인증서보기](../images/2022-08-03-SSL/2022-08-03-45인증서보기.PNG)

https://www.c12.kh 로 들어가시면 아까 https://172.16.0.120에 들어 갔을때와 똑같이 화면이 나올 겁니다.

똑같이 예외추가 > 보안 예외 확인 눌러주시고 인증서 똑같이 확인 해 주시면 됩니다.

<br>

